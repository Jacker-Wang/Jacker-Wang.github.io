# 添加yarn队列

配置YARN队列调度策略：

（1）配置项(此项可以在ambari上面yarn的customer yarn-site中配置)：
```
yarn.resourcemanager.scheduler.class
```
值：
```
org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler
```
（2）配置项(此项可以在ambari上面yarn的customer yarn-site中配置)：
```
yarn.scheduler.fair.allocation.file
```
值：
```
/etc/hadoop/conf/fair-scheduler.xml
```
3.创建YARN队列配置文件：

在YARN所有ResourceManager主机/etc/hadoop/conf/下创建文件fair-scheduler.xml与mapred-queues.xml，内容示例如下。

default是默认队列，下面的配置添加了alogic队列

（1）fair-scheduler.xml
内容示例：
```
<?xml version="1.0"?>
<allocations>
  <queue name="default">
    <minResources>6000 mb,0vcores</minResources>
    <schedulingPolicy>fair</schedulingPolicy>
    <aclAdministerApps>default</aclAdministerApps>
  </queue>
  <queue name="alogic">
    <minResources>6000 mb,0vcores</minResources>
    <schedulingPolicy>fair</schedulingPolicy>
    <aclAdministerApps>default</aclAdministerApps>
  </queue>
</allocations>
```
（2）mapred-queues.xml
```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<queues>
  <queue>
    <name>default</name>
    <state>running</state>
    <acl-submit-job> </acl-submit-job>
    <acl-administer-jobs> </acl-administer-jobs>
  </queue>
  <queue>
    <name>alogic</name>
    <state>running</state>
    <acl-submit-job>alogic</acl-submit-job>
    <acl-administer-jobs>alogic,hue</acl-administer-jobs>
   </queue>
</queues>
```

若需要添加YARN队列，则在/etc/hadoop/conf/fair-scheduler.xm中中仿照示例添加<queue>标签内容。并且在/etc/hadoop/conf/mapred-queues.xml中添加相关队列。

# HA状态下的namenode格式化

1 停止所有namenode（stanby namenode和active namenode）

2 删除所有主机的datanode数据目录和namenode目录

3 开启所有的Journalnode服务

4 格式化zkfc

注意这里格式化所有的azfc（一般是2台）
```
  hdfs zkfc -formatZK
```

5 格式化namenode

 ```
  hdfs namenode -format
 ```

 6 拷贝namenode文件导另外一台namenode

    拷贝目录/~/hadoop/hdfs/namenode下面的所有文件。

 7 启动namenode
